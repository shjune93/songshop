//ajax구현


String.prototype.format = function() {
  var args = arguments;
  return this.replace(/{(\d+)}/g, function(match, number) {
    return typeof args[number] != 'undefined'
        ? args[number]
        : match
        ;
  });
};

$(".answer-write input[type=submit]").click(addAnswer); //해당 요소 클릭했을때

function addAnswer(e){
	e.preventDefault(); // 기본 동작 멈추기
	console.log("click me");
	
	var queryString=$(".answer-write").serialize();//서버로 전달할 데이터 읽어오기
	console.log("query :" + queryString);//쿼리 찍어보기

	var url=$(".answer-write").attr("action");//action이라는 속성의 url을 가져옴
	console.log("url : " + url)
	$.ajax({
			type:'post',
			url: url,
			data: queryString,
			//dataType:'json',
			success:onSuccess,
			error:onError
		});
}

function onSuccess(data,status){
	console.log(data);
	
//	var answerTemplate=$("#answerTemplate").html();
//	var template=answerTemplate.format(
//			data.writer.userId,
//			data.formattedCreateDate,
//			data.contents,
//			data.question.id,
//			data.id
//			
//			);
//	$(".qna-comment-slipp-articles").prepend(template);
//	
//	$("textarea[name=contents]").val("");
}
$(".link-delete-article").click(deleteAnswer);
	

function deleteAnswer(e){
	e.preventDefault();
	var deleteBtn=$(this);
	var url=$(this).attr("href");
	console.log("url : " +url);
	
	$.ajax({
		type:'delete',
		url:url,
		dataType:'json',
		error:function(xhr,status){
			console.log("error");
		},
		success:function(data,status){
			console.log(data);
			if(data.valid){
				deleteBtn.closest("article").remove();
			}else{
				alert(data.errorMessage);
			}
			
		}
	});
}



function onError(){
	console.log("error")
}


